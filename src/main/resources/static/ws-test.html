<!-- ws-test-toggle.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebSocket Test (Local & Remote)</title>
</head>
<body>
<label for="server">ğŸ”Œ Server:</label>
<select id="server">
    <option value="ws://localhost:8080/ws/chat?roomId=testRoom&userId=yunuo">Local (localhost:8000)</option>
    <option value="wss://35.216.106.89:8080/ws/chat?roomId=testRoom&userId=yunuo">Remote (35.216.106.89)</option>
</select>
<button onclick="connect()">Connect</button>
<br><br>

<input id="msg" type="text" placeholder="Message">
<button onclick="sendMsg()">Send</button>
<ul id="log"></ul>

<script>
    let socket;

    function connect() {
        const url = document.getElementById("server").value;

        if (socket && socket.readyState !== WebSocket.CLOSED) {
            socket.close();
            log("ğŸ” Reconnecting...");
        }

        socket = new WebSocket(url);

        socket.onopen = () => log("âœ… Connected to " + url);
        socket.onmessage = (event) => log("ğŸ“© " + event.data);
        socket.onerror = (err) => log("âŒ Error: " + err.message || err);
        socket.onclose = () => log("ğŸ”Œ Connection closed");
    }

    function sendMsg() {
        const msg = document.getElementById("msg").value;
        if (socket && socket.readyState === WebSocket.OPEN) {
            socket.send(msg);
            log("ğŸ“¤ " + msg);
        } else {
            log("âš ï¸ Not connected");
        }
    }

    function log(message) {
        const li = document.createElement("li");
        li.textContent = message;
        document.getElementById("log").appendChild(li);
    }
</script>
</body>
</html>
